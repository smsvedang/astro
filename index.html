<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jyotish Visleshan Form</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #a78bfa; /* violet-400 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #8b5cf6; /* violet-600 */
        }
        /* Style file input button */
        input[type="file"]::file-selector-button {
            margin-right: 1rem;
            padding: 0.5rem 1rem;
            border-radius: 9999px; /* full */
            border: 0;
            font-size: 0.875rem; /* sm */
            font-weight: 600; /* semibold */
            background-color: #ede9fe; /* violet-100 */
            color: #6d28d9; /* violet-700 */
            transition: background-color 0.2s;
        }
        input[type="file"]::file-selector-button:hover {
            background-color: #ddd6fe; /* violet-200 */
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-100 via-indigo-100 to-violet-200 min-h-screen p-4 md:p-8">

    <main class="max-w-5xl mx-auto bg-white/90 backdrop-blur-lg p-6 md:p-10 rounded-2xl shadow-2xl border border-gray-200">
        
        <!-- Form Header -->
        <div class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-indigo-800 mb-2">
                Jyotish Visleshan Form
            </h1>
            <p class="text-gray-600 text-lg">
                Kripaya apni jankari aur chart upload karein.
            </p>
        </div>

        <!-- Form Start -->
        <form id="astroForm">

            <!-- Section 1: Basic Info -->
            <section class="mb-8">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-5 border-b-2 border-indigo-200 pb-2">
                    Mool Jankari (Basic Info)
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="clientName" class="block text-sm font-medium text-gray-700 mb-2">Aapka Naam (Name)</label>
                        <input type="text" id="clientName" name="clientName" placeholder="Poora naam likhein" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200" required>
                    </div>
                    <div>
                        <label for="clientEmail" class="block text-sm font-medium text-gray-700 mb-2">Email ya Phone</label>
                        <input type="text" id="clientEmail" name="clientEmail" placeholder="Email ya phone number" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition duration-200" required>
                    </div>
                </div>
            </section>

            <!-- Section 2: Chart Uploads -->
            <section class="mb-8">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-5 border-b-2 border-indigo-200 pb-2">
                    1. Chart Upload Karein
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="lagnaChart" class="block text-sm font-medium text-gray-700 mb-2">Lagna Chart Photo</label>
                        <input type="file" id="lagnaChart" name="lagnaChart" accept="image/*" class="block w-full text-sm text-gray-600 file:cursor-pointer" required>
                        <p class="text-xs text-gray-500 mt-1">Sirf image files (JPG, PNG) hi upload karein.</p>
                    </div>
                    <div>
                        <label for="kpChart" class="block text-sm font-medium text-gray-700 mb-2">KP Chart Photo</label>
                        <input type="file" id="kpChart" name="kpChart" accept="image/*" class="block w-full text-sm text-gray-600 file:cursor-pointer" required>
                        <p class="text-xs text-gray-500 mt-1">Sirf image files (JPG, PNG) hi upload karein.</p>
                    </div>
                </div>
            </section>

            <!-- Section 3: Grah aur Nakshatra -->
            <section class="mb-8">
                <h2 class="text-2xl font-semibold text-indigo-700 mb-5 border-b-2 border-indigo-200 pb-2">
                    2. Grah aur Nakshatra
                </h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                    <!-- Planet List -->
                    <!-- Har grah ke liye ek card -->
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_surya" class="block font-medium text-indigo-900 mb-1">Surya (Sun)</label>
                        <input type="text" id="grah_surya" name="grah_surya" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_chandra" class="block font-medium text-indigo-900 mb-1">Chandra (Moon)</label>
                        <input type="text" id="grah_chandra" name="grah_chandra" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_mangal" class="block font-medium text-indigo-900 mb-1">Mangal (Mars)</label>
                        <input type="text" id="grah_mangal" name="grah_mangal" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_budh" class="block font-medium text-indigo-900 mb-1">Budh (Mercury)</label>
                        <input type="text" id="grah_budh" name="grah_budh" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_guru" class="block font-medium text-indigo-900 mb-1">Guru (Jupiter)</label>
                        <input type="text" id="grah_guru" name="grah_guru" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_shukra" class="block font-medium text-indigo-900 mb-1">Shukra (Venus)</label>
                        <input type="text" id="grah_shukra" name="grah_shukra" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_shani" class="block font-medium text-indigo-900 mb-1">Shani (Saturn)</label>
                        <input type="text" id="grah_shani" name="grah_shani" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_rahu" class="block font-medium text-indigo-900 mb-1">Rahu</label>
                        <input type="text" id="grah_rahu" name="grah_rahu" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                    <div class="bg-indigo-50/70 p-4 rounded-lg shadow-sm border border-indigo-100">
                        <label for="grah_ketu" class="block font-medium text-indigo-900 mb-1">Ketu</label>
                        <input type="text" id="grah_ketu" name="grah_ketu" placeholder="Nakshatra..." class="w-full p-2 border border-indigo-200 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition">
                    </div>
                </div>
            </section>
            
            <!-- Section 4: House Significators -->
            <section>
                <h2 class="text-2xl font-semibold text-indigo-700 mb-5 border-b-2 border-indigo-200 pb-2">
                    3. House Significators (Karak)
                </h2>
                <p class="text-gray-600 mb-4 text-sm">Har ghar ke liye significators (grahon ke number, jaise 1, 5, 9) daalein.</p>
                
                <!-- Responsive Table Wrapper -->
                <div class="overflow-x-auto rounded-lg shadow-md border border-gray-200">
                    <table class="w-full min-w-[700px] whitespace-nowrap">
                        <!-- Table Head -->
                        <thead class="bg-indigo-700 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">House</th>
                                <th class="p-3 text-left font-semibold text-sm">L1 (Planet)</th>
                                <th class="p-3 text-left font-semibold text-sm">L2 (Star)</th>
                                <th class="p-3 text-left font-semibold text-sm">L3 (Sub)</th>
                                <th class="p-3 text-left font-semibold text-sm">L4 (Sub-Sub)</th>
                            </tr>
                        </thead>
                        <!-- Table Body -->
                        <tbody class="divide-y divide-gray-200 bg-white">
                            <!-- Rows 1-12 -->
                            <!-- Row 1 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 1</td>
                                <td class="p-2"><input type="text" name="h1_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h1_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h1_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h1_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 2 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 2</td>
                                <td class="p-2"><input type="text" name="h2_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h2_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h2_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h2_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 3 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 3</td>
                                <td class="p-2"><input type="text" name="h3_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h3_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h3_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h3_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 4 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 4</td>
                                <td class="p-2"><input type="text" name="h4_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h4_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h4_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h4_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 5 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 5</td>
                                <td class="p-2"><input type="text" name="h5_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h5_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h5_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h5_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 6 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 6</td>
                                <td class="p-2"><input type="text" name="h6_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h6_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h6_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h6_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 7 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 7</td>
                                <td class="p-2"><input type="text" name="h7_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h7_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h7_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h7_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 8 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 8</td>
                                <td class="p-2"><input type="text" name="h8_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h8_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h8_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h8_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 9 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 9</td>
                                <td class="p-2"><input type="text" name="h9_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h9_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h9_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h9_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 10 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 10</td>
                                <td class="p-2"><input type="text" name="h10_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h10_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h10_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h10_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 11 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 11</td>
                                <td class="p-2"><input type="text" name="h11_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h11_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h11_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h11_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                            <!-- Row 12 -->
                            <tr class="hover:bg-gray-50 transition">
                                <td class="p-2 font-medium text-gray-800 text-center">House 12</td>
                                <td class="p-2"><input type="text" name="h12_l1" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h12_l2" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h12_l3" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                                <td class="p-2"><input type="text" name="h12_l4" class="w-full p-2 border-0 rounded-md bg-gray-50 focus:ring-2 focus:ring-indigo-400 focus:bg-white transition"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Submit Button & Feedback -->
            <div class="text-center mt-10">
                <button type="submit" id="submitButton" class="bg-indigo-600 text-white font-bold py-3 px-10 rounded-full text-lg shadow-lg hover:bg-indigo-700 transition duration-300 ease-in-out transform hover:-translate-y-1 focus:outline-none focus:ring-4 focus:ring-indigo-300">
                    Form Jama Karein
                </button>
                
                <!-- Loading Message -->
                <div id="loadingMessage" class="hidden text-indigo-600 mt-4 animate-pulse">
                    Submit ho raha hai, kripaya prateeksha karein...
                </div>
                
                <!-- Success Message -->
                <div id="successMessage" class="hidden text-green-700 bg-green-100 border border-green-300 p-4 rounded-lg mt-4 max-w-md mx-auto">
                    <strong class="font-semibold">Dhanyavaad!</strong> Aapka form safaltapoorvak jama ho gaya hai.
                </div>
            </div>

        </form>
    </main>

    <!-- 
    ===============================================================
    DEVELOPER NOTE: GOOGLE SHEETS INTEGRATION
    ===============================================================
    
    Yeh form abhi data collect karta hai lekin Google Sheet se connect nahi hai.
    Isko connect karne ke liye, aapko Google Apps Script ka upyog karna hoga.

    Steps:
    1. Ek new Google Sheet banayein.
    2. Extensions > Apps Script par jaayein.
    3. Niche diye gaye script ko Apps Script editor mein paste karein (File upload wala part complex hai aur uske liye Drive API setup lagega, yeh script sirf text data ke liye hai):

    function doPost(e) {
      try {
        var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
        
        // Form data se values nikaalein
        var data = e.parameter;
        
        // Ek nayi row mein data add karein
        // Column names ko apne form 'name' attributes se match karein
        sheet.appendRow([
          new Date(),
          data.clientName,
          data.clientEmail,
          data.grah_surya,
          data.grah_chandra,
          // ... baaki saare grah ...
          data.h1_l1,
          data.h1_l2,
          data.h1_l3,
          data.h1_l4,
          data.h2_l1,
          // ... baaki saare houses ...
        ]);
        
        // Success response bhejein
        return ContentService.createTextOutput(JSON.stringify({ "result": "success" })).setMimeType(ContentService.MimeType.JSON);
      
      } catch (error) {
        // Error response bhejein
        return ContentService.createTextOutput(JSON.stringify({ "result": "error", "message": error.message })).setMimeType(ContentService.MimeType.JSON);
      }
    }

    4. Deploy > New Deployment par click karein.
    5. Type "Web app" select karein.
    6. "Who has access" ko "Anyone" par set karein.
    7. "Deploy" par click karein aur Web App URL ko copy karein.

    8. Photo upload ke liye, aapko Google Drive API ko enable karna hoga aur Apps Script ko modify karna hoga taaki woh file data ko Base64 format mein receive karke Drive mein save kar sake. Yeh ek advanced task hai.

    9. Niche diye gaye JavaScript code mein 'YOUR_WEB_APP_URL_HERE' ko apne URL se replace karein.
    
    ===============================================================
    -->

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('astroForm');
            const submitButton = document.getElementById('submitButton');
            const loadingMessage = document.getElementById('loadingMessage');
            const successMessage = document.getElementById('successMessage');

            // ==========================================================
            // YAHAN APNA GOOGLE APPS SCRIPT WEB APP URL PASTE KAREIN
            // (Jo aapne Step 11 mein copy kiya tha)
            // ==========================================================
            const scriptURL = 'https://script.google.com/macros/s/AKfycbytQaBKorg2aVQEO6KEBKVK47c5HiI2lSY_ghtgQ2b9cuPCLlr98wmL7jD-swm1gyvA/exec';
            // ==========================================================


            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // Form ko default submit se rokein

                // Check karein ki URL set hai ya nahi
                if (scriptURL === 'YOUR_WEB_APP_URL_HERE') {
                    // Custom error message (alert ki jagah)
                    loadingMessage.classList.remove('hidden');
                    loadingMessage.textContent = 'ERROR: Google Apps Script URL set nahi hai. HTML code mein scriptURL variable ko update karein.';
                    loadingMessage.classList.add('text-red-600');
                    return;
                }

                // --- Asli Google Apps Script Code ---
                
                // 1. Loading state dikhayein
                submitButton.disabled = true;
                submitButton.textContent = 'Submitting...';
                loadingMessage.classList.remove('hidden');
                loadingMessage.classList.remove('text-red-600');
                loadingMessage.textContent = 'Submit ho raha hai, kripaya prateeksha karein...';
                successMessage.classList.add('hidden');

                try {
                    // 2. Files ko Base64 mein convert karein
                    const lagnaChartFile = document.getElementById('lagnaChart').files[0];
                    const kpChartFile = document.getElementById('kpChart').files[0];

                    if (!lagnaChartFile || !kpChartFile) {
                        throw new Error('Kripaya dono chart photo upload karein.');
                    }

                    // Dono files ko convert karein
                    const lagnaChartBase64 = await fileToBase64(lagnaChartFile);
                    const kpChartBase64 = await fileToBase64(kpChartFile);

                    // 3. Form data object banayein
                    const formData = new FormData(form);
                    const data = {};
                    formData.forEach((value, key) => {
                        // File data ko chhodkar baaki sab le lein
                        if (key !== 'lagnaChart' && key !== 'kpChart') {
                            data[key] = value;
                        }
                    });
                    
                    // 4. Poora payload (text + files) banayein
                    const payload = {
                        ...data,
                        lagnaChartName: lagnaChartFile.name,
                        lagnaChartType: lagnaChartFile.type,
                        lagnaChartBase64: lagnaChartBase64,
                        kpChartName: kpChartFile.name,
                        kpChartType: kpChartFile.type,
                        kpChartBase64: kpChartBase64,
                    };

                    // 5. Data ko fetch API se bhejein
                    const response = await fetch(scriptURL, {
                        method: 'POST',
                        mode: 'cors', // CORS enabled hona zaroori hai
                        headers: {
                            // Bata rahe hain ki hum JSON bhej rahe hain
                            'Content-Type': 'application/json',
                        },
                        // Data ko JSON string mein convert karein
                        body: JSON.stringify(payload)
                    });
                    
                    // Apps Script se text response milta hai, use parse karein
                    const resultText = await response.text();
                    const result = JSON.parse(resultText);

                    if (result.result === 'success') {
                        // Success
                        loadingMessage.classList.add('hidden');
                        successMessage.classList.remove('hidden');
                        form.reset();
                        
                        // Success message ko 5 second baad hide karein
                        setTimeout(() => {
                            successMessage.classList.add('hidden');
                        }, 5000);
                        
                    } else {
                        // Error from Apps Script
                        throw new Error(result.message || 'Apps Script se unknown error aaya.');
                    }

                } catch (error) {
                    console.error('Error!', error.message);
                    // Custom error message dikhayein
                    loadingMessage.textContent = 'Error: ' + error.message;
                    loadingMessage.classList.add('text-red-600');
                    // Error ko thodi der baad hide karein
                    setTimeout(() => {
                         loadingMessage.classList.add('hidden');
                         loadingMessage.classList.remove('text-red-600');
                         loadingMessage.textContent = 'Submit ho raha hai, kripaya prateeksha karein...';
                    }, 5000);
                } finally {
                    // 6. Button ko re-enable karein
                    submitButton.disabled = false;
                    submitButton.textContent = 'Form Jama Karein';
                }
            });

            /**
             * Helper function: File ko Base64 string mein convert karein
             */
            function fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve(reader.result);
                    reader.onerror = error => reject(error);
                });
            }
        });
    </script>

</body>
</html>